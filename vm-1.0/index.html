<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ToDoList</title>
    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <script src="./src/vm.js"></script>
</head>
<body>
    <div class="container">
        <div class="form-group form-inline" style="margin: 20px auto;">
            <input class="form-control number" type="text" 
                data-vm="num" 
                data-show="show"
            >
            <button class="btn btn-default" type="button" id="button">显示/隐藏</button>
            <button class="btn btn-default" type="button" id="add">将此项目添加到列表</button>
        </div>
        <div data-vm="num">
        </div>

        <div class="alert alert-warning">
            <span>列表总和：</span>
        </div>

        <v-list></v-list>

    </div>
</body>

<script>



var vm = new $vm({
    data: {
        show: true,          //控制input是否显示
        num:  10,           //绑定Input输入框的值
        list: [0, 1, 2, 3]           //列表
    },
    // 数据就绪后初始化执行生命周期
    created: function() {

    },
    components: {
        'v-list': {
            name: 'v-list',
            props: ['list'],
            h() {
                var list = ''
                this.list.forEach((item, index) => {
                    var dom = `
                    <li class="alert-success">
                        <span>${item}</span>
                        <span style="float: right;" class="delete" data-index="${index}">删除</span>
                    </li>
                    `
                    list += dom
                })
                $('v-list').html(list)
            }
        }
    },
    watch: {  // 观察者
        list(val) {

        }
    },
    event: function() { // this指向实例
        var vm = this

        // 点击显示隐藏按钮
        $('#button').click(() => {
            // 如果打开就关闭 否则打开
            this.data.show
                ? this.set('show', false)
                : this.set('show', true)
        })
        //添加项目到列表
        $('#add').click(() => {
            this.data.list.push(this.data.num)
            this.set('list', this.data.list)
        })
        //删除
        $('body').on('click', '.delete', function() {
            var index = $(this).attr('data-index')
            vm.data.list.splice(index, 1)
            vm.set('list', vm.data.list)
        })
    }
})

</script>
</html>